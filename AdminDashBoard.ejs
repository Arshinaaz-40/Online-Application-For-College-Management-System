<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="/css/AdminDashBoard.css">
     <style>
/*
body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    background-color: #f4f4f4;
}


#MainHeading {
    display: flex;
    align-items: center;
    justify-content: space-between;
    background-color: #004080;
    color: white;
    padding: 15px;
}

#MainHeading img {
    border-radius: 50%;
    margin-right: 10px;
}


nav {
    background-color: #0056b3;
    padding: 10px;
    text-align: center;
}

nav ul {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    justify-content: center;
}

nav ul li {
    margin: 0 15px;
}

nav ul li a {
    text-decoration: none;
    color: white;
    font-size: 18px;
    transition: color 0.3s;
}

nav ul li a:hover {
    color: #ffcc00;
}

#AdminOptionsBar {
    padding: 15px;
    background: #e3f2fd;
    display: flex;
    justify-content: center;
    border-bottom: 2px solid #004080;
}

#AdminOptionsBar .btn {
    margin: 0 10px;
}


.container {
    margin-top: 20px;
    padding: 20px;
    background: white;
    border-radius: 10px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

#studentsTable {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
}

#studentsTable th, #studentsTable td {
    padding: 10px;
    border: 1px solid #ddd;
    text-align: left;
}

#studentsTable th {
    background-color: #004080;
    color: white;
}

#studentsTable tbody tr:hover {
    background-color: #f1f1f1;
}


#SearchSection {
    display: flex;
    justify-content: center;
    align-items: center;
    margin: 20px;
}

#searchRollNumber {
    width: 300px;
    margin-right: 10px;
}
@media (max-width: 768px) {
    nav ul {
        flex-direction: column;
    }
    
    #AdminOptionsBar {
        flex-direction: column;
        align-items: center;
    }
}
*/
/* Global Styles */
body {
    font-family: Arial, sans-serif;
    background-color: #f4f4f4;
    margin: 0;
    padding: 0;
    text-align: center;
}

/* Header */
#MainHeading {
    display: flex;
    align-items: center;
    justify-content: space-between;
    background: #004d99;
    color: white;
    padding: 15px 20px;
}

#MainHeading h1 {
    margin: 0;
    font-size: 24px;
}

#MainHeading h3 {
    font-size: 18px;
}

/* Navigation */
nav {
    background: #003366;
    padding: 10px 0;
}

nav ul {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    justify-content: center;
}

nav ul li {
    margin: 0 15px;
}

nav ul li a {
    color: white;
    text-decoration: none;
    font-size: 18px;
    padding: 10px 15px;
    display: inline-block;
    transition: 0.3s;
}

nav ul li a:hover {
    background: #0066cc;
    border-radius: 5px;
}

/* Admin Options Bar */
#AdminOptionsBar {
    background: #e0e0e0;
    padding: 10px;
    margin: 15px;
    border-radius: 5px;
}

/* Table Styling */
.container {
    max-width: 95%;
    margin: auto;
    background: white;
    padding: 15px;
    border-radius: 5px;
    box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
}

table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 15px;
}

th, td {
    border: 1px solid #ddd;
    padding: 10px;
    text-align: center;
}

th {
    background: #004d99;
    color: white;
}

tr:nth-child(even) {
    background: #f2f2f2;
}

/* Buttons */
button {
    cursor: pointer;
    padding: 10px 15px;
    font-size: 16px;
    border: none;
    transition: 0.3s;
}

.btn-success {
    background: #28a745;
    color: white;
}

.btn-danger {
    background: #dc3545;
    color: white;
}

.btn-warning {
    background: #ffc107;
    color: black;
}

button:hover {
    opacity: 0.8;
}

/* Responsive Design */
@media screen and (max-width: 768px) {
    #MainHeading {
        flex-direction: column;
        text-align: center;
    }

    nav ul {
        flex-direction: column;
        text-align: center;
    }

    table {
        font-size: 14px;
    }

    th, td {
        padding: 8px;
    }
}

     </style>
</head>
<body>
<div id="MainHeading">
    <img src="/images/bitswgl_logo.jpg" alt="" height="50px" width="50px">
    <h1>BITS College OAMS <i class="bi bi-mortarboard-fill"></i></h1>
    <h3><i class="bi bi-person-circle"></i>&nbsp;Admin</h3>
    </div>
    
    <nav>
    <ul>
        <li><a href="/adminDashboard"><i class="bi bi-card-checklist"></i>Applications</a>

        </li><li><a href="/AdminSearchPage"><i class="bi bi-search"></i> Search </a></li>
        
    <li><a href="/notifications"><i class="bi bi-bell"></i> Notifications </a></li>

        <li><a href="/AdminLoginPage"><i class="bi bi-box-arrow-right"></i> Logout</a></li>
    </ul>
    </nav>
    
    <div id="AdminOptionsBar">
    <nav class="navbar navbar-expand-lg">
        <div class="container-fluid">
            <button class="btn btn-success" onclick="fetchApplications()"><i class="bi bi-eye"></i> Show Applications</button>
            <button class="btn btn-danger" onclick="window.print()"><i class="bi bi-printer"></i> Print</button>
            <button class="btn btn-warning" id="clearApplications"><i class="bi bi-x-circle"></i> Clear</button>
        </div>
    </nav>
    </div>
    
    <section class="container">
    <table id="studentsTable">
        <thead>
            <tr>
                <th>ID</th>
                <th>Full Name</th>
                <th>Email</th>
                <th>Mobile</th>
                <th>Hall Ticket</th>
                <th>Passout Year</th>
                <th>Branch</th>
                <th>Apply For</th>
                <th>Reason</th>
                <th>Request Date</th>
                <th>Collection Date</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
    
    </section>
    <script>
    document.addEventListener("DOMContentLoaded", function () {
    const tableBody = document.querySelector("#studentsTable tbody");
    const searchInput = document.getElementById("searchRollNumber");
    const resultsDiv = document.getElementById("results");
    
    function fetchApplications() {
    fetch("/get-applications")
        .then(response => response.json())
        .then(data => {
            tableBody.innerHTML = ""; 
    
            if (data.length === 0) {
                tableBody.innerHTML = `<tr><td colspan="11">No applications found.</td></tr>`; // Updated colspan
                return;
            }
    
            data.forEach(application => {
                const row = document.createElement("tr");
                row.innerHTML = `
                    <td>${application.id}</td>
                    <td>${application.fullname}</td>
                    <td>${application.email}</td>
                    <td>${application.mobile}</td>
                    <td>${application.hallticket}</td>
                    <td>${application.passout_year}</td>
                    <td>${application.branch}</td>
                    <td>${application.apply_for}</td>
                    <td>${application.reason}</td>
                    <td>${application.request_date}</td>
                    <td>${application.collection_date || "Not Available"}</td>
                `;
                tableBody.appendChild(row);
            });
        })
        .catch(error => console.error("Error fetching applications:", error));
    }
    
    function searchStudent() {
    const rollNumber = searchInput.value.trim();
    if (rollNumber === "") {
        resultsDiv.innerHTML = `<p style="color: red;">Please enter a Roll Number!</p>`;
        return;
    }
    
    fetch(`/search-application?roll=${rollNumber}`)
        .then(response => response.json())
        .then(data => {
            if (!data) {
                resultsDiv.innerHTML = `<p style="color: red;">No records found for Roll Number: ${rollNumber}</p>`;
                return;
            }
    
            resultsDiv.innerHTML = `
                <h4>Application Details</h4>
                <p><strong>Full Name:</strong> ${data.fullname}</p>
                <p><strong>Email:</strong> ${data.email}</p>
                <p><strong>Mobile:</strong> ${data.mobile}</p>
                <p><strong>Hall Ticket:</strong> ${data.hallticket}</p>
                <p><strong>Passout Year:</strong> ${data.passout_year}</p>
                <p><strong>Branch:</strong> ${data.branch}</p>
                <p><strong>Apply For:</strong> ${data.apply_for}</p>
                <p><strong>Reason:</strong> ${data.reason}</p>
                <p><strong>Request Date:</strong> ${data.request_date}</p>
                <p><strong>Collection Date:</strong> ${data.collection_date || "Not Available"}</p> 
            `;
        })
        .catch(error => console.error("Error searching student:", error));
    }
    
    document.getElementById("clearApplications").addEventListener("click", function () {
    tableBody.innerHTML = "";
    });
    
    window.fetchApplications = fetchApplications;
    window.searchStudent = searchStudent;
    });
    
    </script>
    </body>
    </html>
    
     <!-- <!DOCTYPE html>
     <html lang="en">
     <head>
         <meta charset="UTF-8">
         <meta name="viewport" content="width=device-width, initial-scale=1.0">
         <title>Admin Dashboard</title>
         <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
         <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
         <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
         <style>
             body {
                 font-family: Arial, sans-serif;
                 background-color: #f4f4f4;
             }
             #MainHeading {
                 display: flex;
                 align-items: center;
                 justify-content: space-between;
                 background-color: #004080;
                 color: white;
                 padding: 15px;
             }
             nav ul {
                 list-style: none;
                 display: flex;
                 justify-content: center;
                 padding: 0;
             }
             nav ul li {
                 margin: 0 15px;
             }
             nav ul li a {
                 text-decoration: none;
                 color: white;
                 font-size: 18px;
             }
             .container {
                 margin-top: 20px;
                 background: white;
                 border-radius: 10px;
                 box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
                 padding: 20px;
             }
             #studentsTable {
                 width: 100%;
                 border-collapse: collapse;
             }
             #studentsTable th, #studentsTable td {
                 padding: 10px;
                 border: 1px solid #ddd;
                 text-align: left;
             }
             #studentsTable th {
                 background-color: #004080;
                 color: white;
             }
         </style>
     </head>
     <body>
         <div id="MainHeading">
             <img src="/images/bitswgl_logo.jpg" alt="BITS Logo" height="50px" width="50px">
             <h1>BITS College OAMS <i class="bi bi-mortarboard-fill"></i></h1>
             <h3><i class="bi bi-person-circle"></i> Admin</h3>
         </div>
         <nav>
             <ul>
                 <li><a href=""><i class="bi bi-card-checklist"></i> Applications</a></li>
                 <li><a href="/AdminLoginPage"><i class="bi bi-box-arrow-right"></i> Logout</a></li>
             </ul>
         </nav>
         <div class="container">
             <table id="studentsTable">
                 <thead>
                     <tr>
                         <th>ID</th>
                         <th>Full Name</th>
                         <th>Email</th>
                         <th>Hall Ticket</th>
                         <th>Apply For</th>
                         <th>Request Date</th>
                         <th>Collection Date</th>
                         <th>Status</th>
                         <th>Action</th>
                     </tr>
                 </thead>
                 <tbody></tbody>
             </table>
         </div>
         <script>
             function fetchApplications() {
                 fetch("/get-applications")
                     .then(response => response.json())
                     .then(data => {
                         let tableBody = document.querySelector("#studentsTable tbody");
                         tableBody.innerHTML = "";
                         data.forEach(application => {
                             let row = `<tr>
                                 <td>${application.id}</td>
                                 <td>${application.fullname}</td>
                                 <td>${application.email}</td>
                                 <td>${application.hallticket}</td>
                                 <td>${application.apply_for}</td>
                                 <td>${application.request_date}</td>
                                 <td>${application.collection_date || "Not Available"}</td>
                                 <td>
                                     <select class="status-select" data-id="${application.id}">
                                         <option value="Pending" ${application.status === "Pending" ? "selected" : ""}>Pending</option>
                                         <option value="Approved" ${application.status === "Approved" ? "selected" : ""}>Approved</option>
                                         <option value="Rejected" ${application.status === "Rejected" ? "selected" : ""}>Rejected</option>
                                     </select>
                                 </td>
                                 <td><button class="btn btn-primary update-status" data-id="${application.id}">Update</button></td>
                             </tr>`;
                             tableBody.innerHTML += row;
                         });
                     })
                     .catch(error => console.error("Error fetching applications:", error));
             }
     
             document.addEventListener("click", function (event) {
                 if (event.target.classList.contains("update-status")) {
                     const appId = event.target.getAttribute("data-id");
                     const status = document.querySelector(`.status-select[data-id="${appId}"]`).value;
                     fetch("/update-status", {
                         method: "POST",
                         headers: { "Content-Type": "application/json" },
                         body: JSON.stringify({ id: appId, status: status })
                     })
                     .then(response => response.json())
                     .then(data => {
                         if (data.success) {
                             alert("Status updated successfully!");
                             fetchApplications();
                         } else {
                             alert("Error updating status.");
                         }
                     })
                     .catch(error => console.error("Error:", error));
                 }
             });
     
             document.addEventListener("DOMContentLoaded", fetchApplications);
         </script>
     </body>
     </html> -->